(()=>{"use strict";const t=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},e=t=>JSON.parse(localStorage.getItem(t)),n=document.querySelector(".list"),s=(t,e)=>t.done-e.done,a=({text:t,done:e,id:n})=>{const s=document.createElement("li");s.classList.add("list-item");const a=(({done:t,id:e})=>{const n=document.createElement("input");return n.setAttribute("type","checkbox"),n.checked=t,n.classList.add("list-item__checkbox"),n.setAttribute("data-id",e),n})({done:e,id:n}),i=document.createElement("span");e&&s.classList.add("list-item_done"),i.textContent=t;const c=document.createElement("button");return c.classList.add("list-item__delete-btn"),c.setAttribute("data-id",n),s.append(a,i,c),s},i=()=>{const t=e("tasksList")||[];n.innerHTML="";const i=t.sort(s).map(a);n.append(...i)},c="https://6151c2184a5f22001701d3f3.mockapi.io/api/v1/users",d=()=>fetch(c).then((t=>t.json())).then((t=>(t=>t.map((({id:t,...e})=>({...e,id:t}))))(t))),o=()=>{const e=document.querySelector(".task-input"),n=e.value;if(!n)return;e.value="";var s;(s={text:n,done:!1,createDate:(new Date).toISOString()},fetch(c,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(s)})).then((()=>d())).then((e=>{t("tasksList",e),i()}))},r=n=>{const s=n.target.classList.contains("list-item__checkbox"),a=n.target.classList.contains("list-item__delete-btn"),o=n.target.dataset.id,r=e("tasksList"),{text:l,createDate:u}=r.find((t=>t.id===o)),h=n.target.checked,m={text:l,createDate:u,done:h,finishDate:h?(new Date).toISOString():null};s&&((t,e)=>fetch(`${c}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}))(o,m).then((()=>d())).then((e=>{t("tasksList",e),i()})),a&&(t=>fetch(`${c}/${t}`,{method:"DELETE"}))(o).then((()=>d())).then((e=>{t("tasksList",e),i()}))};document.addEventListener("DOMContentLoaded",(()=>{d().then((e=>{t("tasksList",e),i()})),document.querySelector(".create-task-btn").addEventListener("click",o),document.querySelector(".list").addEventListener("click",r)})),window.addEventListener("storage",(t=>{"tasksList"===t.key&&i()}))})();